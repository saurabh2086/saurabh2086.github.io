<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predictive Distributions: Coin Spin Expectation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0KOVEMcApdbeGsNNFNdYmM8AEwMwjiJdUT7BMM9q+mkdCIFoQuW" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0i" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #d1d5db;
        }
        .card {
            background-color: #1f2937;
            border: 1px solid #374151;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
        }
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #374151;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
            border-radius: 9999px;
        }
        .slider:hover {
            opacity: 1;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid #1f2937;
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid #1f2937;
        }
        .bar-chart-container {
            height: 250px;
        }
        .bar {
            transition: height 0.3s ease-in-out, background-color 0.3s ease-in-out;
        }
        .home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #2c3e50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        .home-button:hover {
            background: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <a href="index.html" class="home-button">
        ‚Üê Home
    </a>

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-white mb-2">Expected Number of Spins for a Head</h1>
            <p class="text-lg text-gray-400">Coin Spin Expectation Problem</p>
        </header>

        <!-- Original Question Card -->
        <div class="card">
            <h2 class="text-2xl font-semibold text-white mb-4">The Question</h2>
            <p class="text-gray-300 leading-relaxed">
                Consider two coins, $C_1$ and $C_2$, with the following characteristics: $\Pr(\text{heads} | C_1) = 0.6$ and $\Pr(\text{heads} | C_2) = 0.4$. Choose one of the coins at random and imagine spinning it repeatedly. Given that the first two spins from the chosen coin are tails, what is the expectation of the number of additional spins until a head shows up?
            </p>
        </div>

        <!-- Detailed Solution Card -->
        <div class="card">
            <h2 class="text-2xl font-semibold text-white mb-4">Detailed Step-by-Step Solution</h2>
            <div class="space-y-6 text-gray-300 leading-relaxed">
                <div>
                    <h3 class="font-semibold text-lg text-blue-400 mb-2">Part 1: Updating Our Beliefs (Bayesian Inference)</h3>
                    <p>We start by assuming we have no information other than a coin was chosen "at random". This means our initial beliefs (prior probabilities) are equal.</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li><span class="font-semibold">Prior $P(C_1)$:</span> 0.5</li>
                        <li><span class="font-semibold">Prior $P(C_2)$:</span> 0.5</li>
                    </ul>
                    <p class="mt-4">Next, we incorporate the new evidence: two tails in a row (TT). We calculate the probability of this evidence occurring for each coin (the likelihood).</p>
                     <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li><span class="font-semibold">$P(\text{Tails} | C_1) = 1 - 0.6 = 0.4$.</span> So, $P(\text{TT} | C_1) = 0.4 \times 0.4 = 0.16$.</li>
                        <li><span class="font-semibold">$P(\text{Tails} | C_2) = 1 - 0.4 = 0.6$.</span> So, $P(\text{TT} | C_2) = 0.6 \times 0.6 = 0.36$.</li>
                    </ul>
                    <p class="mt-4">Using Bayes' Theorem, we find the updated (posterior) probabilities. We see that observing two tails makes it more likely we have Coin 2.</p>
                    <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li><span class="font-semibold">Posterior $P(C_1 | \text{TT})$:</span> $\frac{0.16 \times 0.5}{0.16 \times 0.5 + 0.36 \times 0.5} = \frac{0.08}{0.26} = \mathbf{\frac{4}{13}} \approx 0.308$</li>
                        <li><span class="font-semibold">Posterior $P(C_2 | \text{TT})$:</span> $\frac{0.36 \times 0.5}{0.16 \times 0.5 + 0.36 \times 0.5} = \frac{0.18}{0.26} = \mathbf{\frac{9}{13}} \approx 0.692$</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold text-lg text-blue-400 mb-2">Part 2: Calculating the Final Expectation</h3>
                    <p>The number of spins until a success (a head) follows a Geometric distribution. The expected number of trials for an event with probability $p$ is $\frac{1}{p}$.</p>
                     <ul class="list-disc list-inside mt-2 space-y-1 pl-2">
                        <li><span class="font-semibold">Expected Spins for $C_1$:</span> $E[\text{Spins}|C_1] = \frac{1}{P(\text{Heads} | C_1)} = \frac{1}{0.6} = \frac{5}{3} \approx 1.67$</li>
                        <li><span class="font-semibold">Expected Spins for $C_2$:</span> $E[\text{Spins}|C_2] = \frac{1}{P(\text{Heads} | C_2)} = \frac{1}{0.4} = \frac{5}{2} = 2.5$</li>
                    </ul>
                    <p class="mt-4">Finally, we calculate the total expectation by taking a weighted average, using our posterior probabilities as the weights.</p>
                    <div class="mt-2 pl-4 border-l-4 border-blue-500 bg-gray-800 p-3 rounded-r-lg overflow-x-auto">
                        $E[\text{Spins}] = P(C_1 | \text{TT}) \times E[\text{Spins}|C_1] + P(C_2 | \text{TT}) \times E[\text{Spins}|C_2]$<br>
                        $E[\text{Spins}] = \left(\frac{4}{13}\right) \times \left(\frac{5}{3}\right) + \left(\frac{9}{13}\right) \times \left(\frac{5}{2}\right)$<br>
                        $E[\text{Spins}] = \frac{20}{39} + \frac{45}{26} = \frac{40}{78} + \frac{135}{78} = \frac{175}{78} \approx \mathbf{2.24 \text{ spins}}$
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Interactive Web App Card -->
        <div class="card">
            <h2 class="text-2xl font-semibold text-white mb-2">Interactive Calculator</h2>
            <p class="text-gray-400 mb-6">Use the slider to see how the posterior probabilities and expected spins change as you observe more tails in a row.</p>

            <!-- Slider -->
            <div class="mb-6">
                <label for="tails-slider" class="block mb-2 font-medium text-gray-300">Number of Initial Tails: <span id="slider-value" class="font-bold text-blue-400">2</span></label>
                <input id="tails-slider" type="range" min="1" max="10" value="2" class="slider">
            </div>

            <!-- Results Display -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Expected Value Display -->
                <div class="bg-gray-800 p-6 rounded-lg text-center">
                    <h3 class="text-lg font-semibold text-gray-300 mb-2">Expected Additional Spins for a Head</h3>
                    <p id="expected-value" class="text-4xl font-bold text-white">2.24</p>
                </div>

                <!-- PMF Chart -->
                <div class="bg-gray-800 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-300 mb-4 text-center">Posterior Probability of Each Coin</h3>
                    <div class="flex flex-col">
                        <!-- Row for Percentage Labels -->
                        <div class="flex justify-around w-full">
                            <div id="prob-c1-text" class="text-sm font-medium text-blue-400 mb-1 w-1/3 text-center">30.8%</div>
                            <div id="prob-c2-text" class="text-sm font-medium text-indigo-400 mb-1 w-1/3 text-center">69.2%</div>
                        </div>

                        <!-- Row for the Bars themselves -->
                        <div class="flex justify-around items-end bar-chart-container">
                            <div id="bar-c1" class="w-1/3 bg-blue-500 rounded-t-md bar"></div>
                            <div id="bar-c2" class="w-1/3 bg-indigo-500 rounded-t-md bar"></div>
                        </div>

                        <!-- Row for Coin Name Labels -->
                        <div class="flex justify-around w-full border-t border-gray-700 pt-2 mt-2">
                             <p class="text-sm font-medium w-1/3 text-center">Coin 1</p>
                             <p class="text-sm font-medium w-1/3 text-center">Coin 2</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- DOM Elements ---
        const slider = document.getElementById('tails-slider');
        const sliderValueDisplay = document.getElementById('slider-value');
        const expectedValueDisplay = document.getElementById('expected-value');
        const probC1Text = document.getElementById('prob-c1-text');
        const probC2Text = document.getElementById('prob-c2-text');
        const barC1 = document.getElementById('bar-c1');
        const barC2 = document.getElementById('bar-c2');

        // --- Constants ---
        const P_HEADS_C1 = 0.6;
        const P_HEADS_C2 = 0.4;
        const P_TAILS_C1 = 1 - P_HEADS_C1;
        const P_TAILS_C2 = 1 - P_HEADS_C2;
        const PRIOR_C1 = 0.5;
        const PRIOR_C2 = 0.5;
        
        const EXPECTED_SPINS_C1 = 1 / P_HEADS_C1;
        const EXPECTED_SPINS_C2 = 1 / P_HEADS_C2;

        /**
         * Calculates and updates the UI based on the number of tails observed.
         */
        function calculateAndUpdate() {
            const numTails = parseInt(slider.value);
            sliderValueDisplay.textContent = numTails;

            // 1. Calculate Likelihoods: P(Data | Hypothesis)
            // Using Math.pow for exponentiation.
            const likelihoodC1 = Math.pow(P_TAILS_C1, numTails);
            const likelihoodC2 = Math.pow(P_TAILS_C2, numTails);

            // 2. Calculate Joint Probabilities: P(Data and Hypothesis)
            const jointC1 = likelihoodC1 * PRIOR_C1;
            const jointC2 = likelihoodC2 * PRIOR_C2;

            // 3. Calculate Evidence (Total Probability of Data): P(Data)
            const evidence = jointC1 + jointC2;
            
            // Handle case where evidence is zero to avoid division by zero
            if (evidence === 0) {
                // This would only happen if probabilities are 0 or 1, and the outcome is impossible.
                // For this problem, it's not a concern but good practice.
                updateUI(0, 0, 0);
                return;
            }

            // 4. Calculate Posterior Probabilities: P(Hypothesis | Data)
            const posteriorC1 = jointC1 / evidence;
            const posteriorC2 = jointC2 / evidence;

            // 5. Calculate Final Weighted Expectation
            const totalExpectation = (posteriorC1 * EXPECTED_SPINS_C1) + (posteriorC2 * EXPECTED_SPINS_C2);
            
            // 6. Update the UI with the new values
            updateUI(totalExpectation, posteriorC1, posteriorC2);
        }

        /**
         * Updates the DOM with the calculated values.
         * @param {number} expectation - The calculated expected number of spins.
         * @param {number} posterior1 - The posterior probability of Coin 1.
         * @param {number} posterior2 - The posterior probability of Coin 2.
         */
        function updateUI(expectation, posterior1, posterior2) {
            expectedValueDisplay.textContent = expectation.toFixed(2);
            
            const posterior1Percent = (posterior1 * 100).toFixed(1);
            const posterior2Percent = (posterior2 * 100).toFixed(1);

            probC1Text.textContent = `${posterior1Percent}%`;
            probC2Text.textContent = `${posterior2Percent}%`;
            
            barC1.style.height = `${posterior1Percent}%`;
            barC2.style.height = `${posterior2Percent}%`;
        }

        // --- Event Listener ---
        slider.addEventListener('input', calculateAndUpdate);

        // --- Initial Calculation ---
        // Run the calculation once on page load to set the initial state.
        document.addEventListener('DOMContentLoaded', () => {
            renderMathInElement(document.body, {
              delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false},
                  {left: '\\[', right: '\\]', display: true}
              ],
              throwOnError : false
            });
            calculateAndUpdate();
        });
    </script>

</body>
</html>