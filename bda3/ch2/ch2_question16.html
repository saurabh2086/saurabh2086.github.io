<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beta-Binomial Distribution Explained</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f8fafc;
            color: #1e293b;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        .math-block {
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1rem 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .step-card {
            border-left: 4px solid #3b82f6;
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .highlight {
            color: #2563eb;
            font-weight: 600;
        }

        .home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #2c3e50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .home-button:hover {
            background: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>

<body class="p-4 md:p-8">
    <a href="../../index.html" class="home-button">
        <i class="fas fa-home"></i> ‚Üê Home
    </a>
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="mb-12 text-center">
            <h1 class="text-4xl font-extrabold text-slate-900 mb-4">The Beta-Binomial Marginal Likelihood</h1>
            <p class="text-lg text-slate-600">A step-by-step derivation of the prior-to-marginal relationship.</p>
        </header>

        <!-- The Problem -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center">
                <span
                    class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm">1</span>
                The Original Question
            </h2>
            <div class="bg-slate-800 text-slate-100 p-6 rounded-xl shadow-lg italic">
                <p class="mb-4">Given the following model hierarchy:</p>
                <ul class="list-disc ml-6 space-y-2">
                    <li>\( p(y|\theta, n) \sim \text{Binomial}(n, \theta) \)</li>
                    <li>\( p(\theta) \sim \text{Beta}(\alpha, \beta) \)</li>
                </ul>
                <p class="mt-4">
                    <strong>(a)</strong> Derive the marginal distribution \( p(y) \).<br>
                    <strong>(b)</strong> Show that if \( \alpha = 1 \) and \( \beta = 1 \), then \( p(y) \) is constant
                    for all \( y \in \{0, 1, \dots, n\} \).
                </p>
            </div>
        </section>

        <!-- The Solution -->
        <section>
            <h2 class="text-2xl font-bold mb-6 flex items-center">
                <span
                    class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center mr-3 text-sm">2</span>
                Detailed Solution
            </h2>

            <!-- Step 1 -->
            <div class="step-card">
                <h3 class="text-xl font-bold mb-3">Step 1: Setting up the Integral</h3>
                <p class="mb-4">To find the marginal distribution \( p(y) \), we must integrate the parameter \( \theta
                    \) out of the joint distribution. This is done by multiplying the likelihood and the prior:</p>
                <div class="math-block">
                    \[ p(y) = \int_{0}^{1} p(y|\theta, n) \, p(\theta) \, d\theta \]
                </div>
                <p>Substituting the density functions:</p>
                <div class="math-block">
                    \[ p(y) = \int_{0}^{1} \left[ \binom{n}{y} \theta^y (1-\theta)^{n-y} \right] \left[
                    \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} \theta^{\alpha-1} (1-\theta)^{\beta-1}
                    \right] d\theta \]
                </div>
            </div>

            <!-- Step 2 -->
            <div class="step-card">
                <h3 class="text-xl font-bold mb-3">Step 2: Simplifying the Kernel</h3>
                <p class="mb-4">Pull the constants (terms not involving \( \theta \)) out of the integral and combine
                    the powers of \( \theta \) and \( (1-\theta) \):</p>
                <div class="math-block">
                    \[ p(y) = \binom{n}{y} \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} \int_{0}^{1}
                    \theta^{y+\alpha-1} (1-\theta)^{n-y+\beta-1} d\theta \]
                </div>
                <p>We recognize the integral as the <span class="highlight">Beta function</span> \( B(y+\alpha,
                    n-y+\beta) \), which evaluates to:</p>
                <div class="math-block">
                    \[ \frac{\Gamma(y+\alpha)\Gamma(n-y+\beta)}{\Gamma(n+\alpha+\beta)} \]
                </div>
            </div>

            <!-- Step 3 -->
            <div class="step-card">
                <h3 class="text-xl font-bold mb-3">Step 3: The Final Marginal Probability</h3>
                <p class="mb-4">Combining everything, we arrive at the Beta-binomial Mass Function:</p>
                <div class="math-block">
                    \[ p(y) = \binom{n}{y} \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}
                    \frac{\Gamma(y+\alpha)\Gamma(n-y+\beta)}{\Gamma(n+\alpha+\beta)} \]
                </div>
            </div>

            <!-- Step 4 -->
            <div class="step-card">
                <h3 class="text-xl font-bold mb-3">Step 4: Proving the Uniform Case (\( \alpha=1, \beta=1 \))</h3>
                <p class="mb-4">If \( \alpha = 1 \) and \( \beta = 1 \), the prior \( p(\theta) \) is a <span
                        class="highlight">Uniform(0, 1)</span> distribution. Let's substitute these values into our
                    result:</p>
                <div class="math-block">
                    \[ p(y) = \binom{n}{y} \frac{\Gamma(1+1)}{\Gamma(1)\Gamma(1)}
                    \frac{\Gamma(y+1)\Gamma(n-y+1)}{\Gamma(n+1+1)} \]
                </div>
                <p class="mb-4">Using the property \( \Gamma(k) = (k-1)! \):</p>
                <div class="math-block">
                    \[ p(y) = \frac{n!}{y!(n-y)!} \cdot \frac{1!}{0!0!} \cdot \frac{y! (n-y)!}{(n+1)!} \]
                </div>
                <p class="mb-4 text-center text-lg">Canceling the factorials:</p>
                <div class="math-block">
                    \[ p(y) = \frac{n!}{(n+1)!} = \frac{n!}{(n+1)n!} = \frac{1}{n+1} \]
                </div>
                <div class="bg-green-50 border-green-200 border p-4 rounded text-green-800">
                    <strong>Conclusion:</strong> Since the result \( \frac{1}{n+1} \) does not depend on \( y \), the
                    distribution is constant (Uniform) across all possible values of \( y \).
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-12 pt-8 border-t border-slate-200 text-center text-slate-500 pb-12">
            <p>Study Assistant &bull; Bayesian Probability Module</p>
        </footer>
    </div>
</body>

</html>