<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predictive Distributions Solution</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        .code-block {
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
        }
        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }
        .number { color: #b5cea8; }
        .home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #2c3e50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        .home-button:hover {
            background: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans leading-relaxed">
    <!-- Home Button -->
    <a href="../../index.html" class="home-button">
        ← Home
    </a>
    <div class="max-w-4xl mx-auto p-6">
        
        <!-- Header -->
        <header class="mb-10 text-center border-b pb-6">
            <h1 class="text-3xl font-bold text-blue-900 mb-2">Predictive Distributions Solution</h1>
            <p class="text-gray-600">Normal Approximation of a Binomial Distribution</p>
        </header>

        <!-- Section 1: The Problem -->
        <section class="mb-12 bg-white p-6 rounded-lg shadow-sm border border-gray-200">
            <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                <span class="bg-blue-100 text-blue-800 text-sm font-semibold mr-3 px-2.5 py-0.5 rounded">1</span>
                The Question
            </h2>
            <div class="italic text-lg text-gray-700 bg-gray-50 p-4 rounded border-l-4 border-blue-500">
                <p class="mb-2"><strong>3. Predictive distributions:</strong> Let \( y \) be the number of 6's in 1000 rolls of a fair die.</p>
                <ul class="list-decimal list-inside ml-4 space-y-1">
                    <li>Sketch the approximate distribution of \( y \), based on the normal approximation.</li>
                    <li>Using the normal distribution table, give approximate 5%, 25%, 50%, 75%, and 95% points for the distribution of \( y \).</li>
                </ul>
            </div>
        </section>

        <!-- Section 2: Mathematical Solution -->
        <section class="mb-12">
            <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                <span class="bg-blue-100 text-blue-800 text-sm font-semibold mr-3 px-2.5 py-0.5 rounded">2</span>
                Mathematical Solution
            </h2>
            
            <div class="space-y-6">
                <!-- Step 1 -->
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg text-blue-800 mb-2">Step 1: Identify Parameters</h3>
                    <p>The number of 6's, \( y \), follows a Binomial distribution \( B(n, p) \) where:</p>
                    <ul class="list-disc list-inside ml-4 mt-2">
                        <li>\( n = 1000 \) (number of rolls)</li>
                        <li>\( p = 1/6 \) (probability of rolling a 6)</li>
                    </ul>
                </div>

                <!-- Step 2 -->
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg text-blue-800 mb-2">Step 2: Normal Approximation</h3>
                    <p>For large \( n \), we approximate \( B(n, p) \) with a Normal distribution \( N(\mu, \sigma^2) \).</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div class="bg-gray-50 p-4 rounded">
                            <p class="font-bold">Mean (\( \mu \)):</p>
                            $$ \mu = np = 1000 \times \frac{1}{6} \approx 166.7 $$
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <p class="font-bold">Standard Deviation (\( \sigma \)):</p>
                            $$ \sigma = \sqrt{np(1-p)} = \sqrt{1000 \cdot \frac{1}{6} \cdot \frac{5}{6}} \approx 11.8 $$
                        </div>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg text-blue-800 mb-2">Step 3: Calculating Percentiles (Part b)</h3>
                    <p class="mb-4">We use the standard normal \( Z \)-scores associated with the requested percentiles and the formula \( y = \mu + Z\sigma \).</p>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left text-gray-600">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                                <tr>
                                    <th class="px-6 py-3">Percentile</th>
                                    <th class="px-6 py-3">Z-Score</th>
                                    <th class="px-6 py-3">Calculation (\( \mu + Z\sigma \))</th>
                                    <th class="px-6 py-3">Result (\( y \))</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-white border-b">
                                    <td class="px-6 py-4 font-medium text-gray-900">5%</td>
                                    <td class="px-6 py-4">-1.645</td>
                                    <td class="px-6 py-4">\( 166.7 + (-1.645)(11.8) \)</td>
                                    <td class="px-6 py-4 font-bold text-blue-600">147.3</td>
                                </tr>
                                <tr class="bg-white border-b">
                                    <td class="px-6 py-4 font-medium text-gray-900">25%</td>
                                    <td class="px-6 py-4">-0.674</td>
                                    <td class="px-6 py-4">\( 166.7 + (-0.674)(11.8) \)</td>
                                    <td class="px-6 py-4 font-bold text-blue-600">158.7</td>
                                </tr>
                                <tr class="bg-white border-b">
                                    <td class="px-6 py-4 font-medium text-gray-900">50%</td>
                                    <td class="px-6 py-4">0.000</td>
                                    <td class="px-6 py-4">\( 166.7 + (0)(11.8) \)</td>
                                    <td class="px-6 py-4 font-bold text-blue-600">166.7</td>
                                </tr>
                                <tr class="bg-white border-b">
                                    <td class="px-6 py-4 font-medium text-gray-900">75%</td>
                                    <td class="px-6 py-4">+0.674</td>
                                    <td class="px-6 py-4">\( 166.7 + (0.674)(11.8) \)</td>
                                    <td class="px-6 py-4 font-bold text-blue-600">174.7</td>
                                </tr>
                                <tr class="bg-white">
                                    <td class="px-6 py-4 font-medium text-gray-900">95%</td>
                                    <td class="px-6 py-4">+1.645</td>
                                    <td class="px-6 py-4">\( 166.7 + (1.645)(11.8) \)</td>
                                    <td class="px-6 py-4 font-bold text-blue-600">186.1</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Visualization -->
        <section class="mb-12">
            <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                <span class="bg-blue-100 text-blue-800 text-sm font-semibold mr-3 px-2.5 py-0.5 rounded">3</span>
                Sketch of Distribution (Part a)
            </h2>
            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center">
                <canvas id="distributionCanvas" width="800" height="400" class="w-full h-auto max-w-3xl"></canvas>
                <p class="text-sm text-gray-500 mt-2">Visual representation of N(166.7, 11.8²) with key percentiles marked.</p>
            </div>
        </section>

        <!-- Section 4: Python Code -->
        <section class="mb-12">
            <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                <span class="bg-blue-100 text-blue-800 text-sm font-semibold mr-3 px-2.5 py-0.5 rounded">4</span>
                Python Code
            </h2>
            <div class="code-block text-sm">
<pre><code><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm

<span class="comment"># 1. Define Parameters</span>
n = <span class="number">1000</span>
p = <span class="number">1</span>/<span class="number">6</span>
mean = n * p
std_dev = np.sqrt(n * p * (<span class="number">1</span> - p))

<span class="keyword">print</span>(<span class="string">f"Mean: {mean:.2f}"</span>)
<span class="keyword">print</span>(<span class="string">f"Standard Deviation: {std_dev:.2f}"</span>)

<span class="comment"># 2. Calculate Percentiles (PPF - Percent Point Function)</span>
percentiles = [<span class="number">0.05</span>, <span class="number">0.25</span>, <span class="number">0.50</span>, <span class="number">0.75</span>, <span class="number">0.95</span>]
results = {}

<span class="keyword">for</span> pct <span class="keyword">in</span> percentiles:
    val = norm.ppf(pct, loc=mean, scale=std_dev)
    results[pct] = val
    <span class="keyword">print</span>(<span class="string">f"{int(pct*100)}% Percentile: {val:.2f}"</span>)

<span class="comment"># 3. Sketch the Distribution</span>
x = np.linspace(mean - <span class="number">4</span>*std_dev, mean + <span class="number">4</span>*std_dev, <span class="number">100</span>)
y = norm.pdf(x, mean, std_dev)

plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))
plt.plot(x, y, label=<span class="string">'Normal Approximation'</span>, color=<span class="string">'blue'</span>)

<span class="comment"># Plot vertical lines for percentiles</span>
<span class="keyword">for</span> pct, val <span class="keyword">in</span> results.items():
    plt.axvline(val, color=<span class="string">'red'</span>, linestyle=<span class="string">'--'</span>, alpha=<span class="number">0.6</span>)
    plt.text(val, max(y)*<span class="number">0.05</span>, <span class="string">f'{int(pct*100)}%'</span>, rotation=<span class="number">90</span>, verticalalignment=<span class="string">'bottom'</span>)

plt.title(<span class="string">'Approximate Distribution of y (Number of 6s)'</span>)
plt.xlabel(<span class="string">'y (count)'</span>)
plt.ylabel(<span class="string">'Probability Density'</span>)
plt.grid(<span class="keyword">True</span>, alpha=<span class="number">0.3</span>)
plt.legend()
plt.show()</span></code></pre>
            </div>
        </section>

    </div>

    <!-- Script to draw the Canvas Chart -->
    <script>
        const canvas = document.getElementById('distributionCanvas');
        const ctx = canvas.getContext('2d');
        
        // Parameters
        const mean = 166.67;
        const sigma = 11.79;
        const percentiles = [
            { pct: 0.05, label: "5%", z: -1.645 },
            { pct: 0.25, label: "25%", z: -0.674 },
            { pct: 0.50, label: "50%", z: 0 },
            { pct: 0.75, label: "75%", z: 0.674 },
            { pct: 0.95, label: "95%", z: 1.645 }
        ];

        function gaussian(x, mu, sigma) {
            return (1 / (sigma * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
        }

        // Drawing Settings
        const width = canvas.width;
        const height = canvas.height;
        const padding = 50;
        const rangeStdDevs = 4; // Draw 4 sigmas on each side
        const minX = mean - (rangeStdDevs * sigma);
        const maxX = mean + (rangeStdDevs * sigma);
        const plotHeight = height - (2 * padding);
        const plotWidth = width - (2 * padding);
        
        // Scale functions
        function scaleX(x) {
            return padding + ((x - minX) / (maxX - minX)) * plotWidth;
        }
        
        // Find max Y for scaling
        const maxY = gaussian(mean, mean, sigma);
        
        function scaleY(y) {
            return height - padding - (y / maxY) * plotHeight;
        }

        // Draw Axes
        ctx.beginPath();
        ctx.strokeStyle = '#aaa';
        ctx.lineWidth = 1;
        // X-axis
        ctx.moveTo(padding, height - padding);
        ctx.lineTo(width - padding, height - padding);
        // Y-axis
        ctx.moveTo(padding, height - padding);
        ctx.lineTo(padding, padding);
        ctx.stroke();

        // Draw Curve
        ctx.beginPath();
        ctx.strokeStyle = '#2563eb'; // Tailwind blue-600
        ctx.lineWidth = 3;
        
        for (let i = 0; i <= plotWidth; i++) {
            const pixelX = padding + i;
            const dataX = minX + (i / plotWidth) * (maxX - minX);
            const dataY = gaussian(dataX, mean, sigma);
            const pixelY = scaleY(dataY);
            
            if (i === 0) ctx.moveTo(pixelX, pixelY);
            else ctx.lineTo(pixelX, pixelY);
        }
        ctx.stroke();

        // Draw Percentile Lines
        percentiles.forEach(p => {
            const val = mean + (p.z * sigma);
            const xPos = scaleX(val);
            const yPos = scaleY(gaussian(val, mean, sigma));
            
            // Dashed Line
            ctx.beginPath();
            ctx.setLineDash([5, 5]);
            ctx.strokeStyle = '#dc2626'; // Tailwind red-600
            ctx.lineWidth = 1;
            ctx.moveTo(xPos, height - padding);
            ctx.lineTo(xPos, yPos);
            ctx.stroke();
            ctx.setLineDash([]);

            // Label
            ctx.fillStyle = '#1e3a8a';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(p.label, xPos, yPos - 10);
            ctx.fillText(val.toFixed(1), xPos, height - padding + 20);
        });

        // Label Axes
        ctx.fillStyle = '#000';
        ctx.font = 'bold 14px sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Number of 6s (y)', width / 2, height - 10);
    </script>
</body>
</html>